# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

## üêõ –ü—Ä–æ–±–ª–µ–º–∞:

–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ç–æ—Ç –∂–µ –∞–∫–∫–∞—É–Ω—Ç –Ø–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–º–µ—Å—Ç–æ –≤—Ö–æ–¥–∞ –ø–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º.

### **–ü—Ä–∏—á–∏–Ω–∞:**
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ –ø–æ `email`, –Ω–æ email –º–æ–≥ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—Ö–æ–¥–µ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

### **–ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è:**
```typescript
// –ë—ã–ª–æ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ email
.eq('email', userEmail)

// –°—Ç–∞–ª–æ: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ yandex_id
.eq('yandex_id', yandexId)
```

### **–û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
```typescript
// –¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è–µ–º email –Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –æ–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è
.update({
  email: userEmail, // –û–±–Ω–æ–≤–ª—è–µ–º email
  name: userName,
  avatar_url: userAvatar,
  yandex_id: yandexId,
  yandex_login: yandexLogin,
  last_login: new Date().toISOString(),
  updated_at: new Date().toISOString()
})
```

## üîÑ –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:

### **–ü—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å:**
1. ‚úÖ –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç –Ø–Ω–¥–µ–∫—Å
2. ‚úÖ –û–±–º–µ–Ω–∏–≤–∞–µ–º –∫–æ–¥ –Ω–∞ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞
3. ‚úÖ –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –Ø–Ω–¥–µ–∫—Å API
4. ‚úÖ **–ò–∑–≤–ª–µ–∫–∞–µ–º `yandex_id` –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä**
5. ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –≤ –ë–î –ø–æ `yandex_id`**
6. ‚úÖ **–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** - –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID
7. ‚úÖ **–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** - —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
8. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
9. ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç

## üõ°Ô∏è –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### **1. –û—Å–Ω–æ–≤–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä:**
- **–ë—ã–ª–æ:** `email` (–º–æ–≥ –∏–∑–º–µ–Ω—è—Ç—å—Å—è)
- **–°—Ç–∞–ª–æ:** `yandex_id` (—Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ø–Ω–¥–µ–∫—Å)

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è:**
```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ yandex_id –≤–º–µ—Å—Ç–æ email
const { data: existingUser } = await supabase
  .from('users')
  .select('*')
  .eq('yandex_id', yandexId) // –°—Ç–∞–±–∏–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  .single()
```

### **3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –ø–æ–ª—è –≤–∫–ª—é—á–∞—è email
.update({
  email: userEmail, // –ù–∞ —Å–ª—É—á–∞–π –∏–∑–º–µ–Ω–µ–Ω–∏—è email
  name: userName,
  avatar_url: userAvatar,
  yandex_id: yandexId,
  yandex_login: yandexLogin,
  last_login: new Date().toISOString(),
  updated_at: new Date().toISOString()
})
```

## üöÄ –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:

### **–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ:**
```
YandexCallback: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –Ø–Ω–¥–µ–∫—Å
YandexCallback: –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–µ–Ω—ã {...}
YandexCallback: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ yandex_id: 12345
YandexCallback: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Supabase
YandexCallback: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –≤ Supabase {...}
```

### **–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ:**
```
YandexCallback: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –Ø–Ω–¥–µ–∫—Å
YandexCallback: –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–µ–Ω—ã {...}
YandexCallback: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ yandex_id: 12345
YandexCallback: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
YandexCallback: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω –≤ Supabase {...}
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

### **–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "email": "user@yandex.ru",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "avatar": "https://avatars.yandex.net/get-yapic/12345/islands-200",
  "provider": "yandex",
  "yandex_id": "12345",
  "yandex_login": "ivan.ivanov",
  "created_at": "2025-01-07T10:00:00Z"
}
```

### **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π):**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000", // –¢–æ—Ç –∂–µ ID
  "email": "user@yandex.ru", // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π email
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)", // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∏–º—è
  "avatar": "https://avatars.yandex.net/get-yapic/12345/islands-200",
  "provider": "yandex",
  "yandex_id": "12345", // –¢–æ—Ç –∂–µ yandex_id
  "yandex_login": "ivan.ivanov",
  "created_at": "2025-01-07T10:00:00Z", // –¢–æ—Ç –∂–µ created_at
  "last_login": "2025-01-07T12:00:00Z" // –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π last_login
}
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç:

- ‚úÖ **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID** –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ
- ‚úÖ **–û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ** (–∏–º—è, –∞–≤–∞—Ç–∞—Ä, email)
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –ø–æ yandex_id
- ‚úÖ **–û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å** –≤ –ë–î

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ç–æ—Ç –∂–µ –∞–∫–∫–∞—É–Ω—Ç –Ø–Ω–¥–µ–∫—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—É–¥–µ—Ç –≤—Ö–æ–¥–∏—Ç—å –ø–æ–¥ —Ç–µ–º –∂–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º, –∞ –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –Ω–æ–≤—ã–π!
