# Интеграция с ChatGPT API

## ✅ Готово к работе!

Интеграция с ChatGPT уже активирована и готова к работе. Просто добавьте API ключ в переменные окружения Vercel.

## Настройка API ключа на Vercel

### 1. Получение API ключа
1. Перейдите на [OpenAI Platform](https://platform.openai.com/)
2. Войдите в свой аккаунт или создайте новый
3. Перейдите в раздел "API Keys"
4. Создайте новый API ключ
5. Скопируйте ключ (он начинается с `sk-`)

### 2. Настройка переменных окружения на Vercel

#### Способ 1: Через Vercel Dashboard
1. Откройте ваш проект в [Vercel Dashboard](https://vercel.com/dashboard)
2. Перейдите в раздел **Settings** → **Environment Variables**
3. Добавьте новую переменную:
   - **Name**: `REACT_APP_CHATGPT_API_KEY`
   - **Value**: `sk-your-api-key-here`
   - **Environment**: Production (и другие если нужно)
4. Нажмите **Save**

#### Способ 2: Через Vercel CLI
```bash
vercel env add REACT_APP_CHATGPT_API_KEY
# Введите ваш API ключ когда попросит
```

### 3. Перезапуск деплоя
После добавления переменной окружения:
1. Перейдите в раздел **Deployments**
2. Нажмите **Redeploy** на последнем деплое
3. Или сделайте новый коммит в Git

## Локальная разработка

Для локальной разработки создайте файл `.env.local` в корне проекта:

```bash
REACT_APP_CHATGPT_API_KEY=sk-your-api-key-here
```

⚠️ **Важно**: Добавьте `.env.local` в `.gitignore` чтобы не коммитить ключ.

## Функциональность

### Что делает интеграция:
- ✅ **Анализирует результаты** теста БПД (баллы, процент, уровень выраженности)
- ✅ **Генерирует персональные рекомендации** на основе симптомов
- ✅ **Учитывает категории** - страх покинутости, нестабильные отношения, импульсивность и др.
- ✅ **Предоставляет конструктивные советы** - конкретные рекомендации
- ✅ **Подчеркивает важность** обращения к специалисту
- ✅ **Тактичный тон** - поддерживающий, без медицинских терминов

### Примеры рекомендаций:
- **Тяжелая выраженность**: "Результаты показывают высокий уровень симптомов БПД. Рекомендуется немедленно обратиться к психологу или психиатру для получения профессиональной помощи. Важно не оставаться с этим один на один."

- **Умеренная выраженность**: "Обнаружены умеренные признаки БПД. Стоит рассмотреть возможность работы с психологом для развития навыков эмоциональной регуляции. Также полезны техники осознанности и стабильный режим дня."

- **Легкая выраженность**: "Результаты указывают на легкие проявления симптомов БПД. Рекомендуется профилактическая работа с психологом и развитие навыков саморегуляции. Полезны техники релаксации и работа с эмоциями."

## Технические детали

### API параметры:
- **Модель**: `gpt-3.5-turbo`
- **Максимум токенов**: 300
- **Температура**: 0.7 (баланс креативности и точности)
- **Системный промпт**: "Ты профессиональный психолог, специализирующийся на пограничном расстройстве личности..."

### Обработка ошибок:
- ✅ **Проверка API ключа** - понятное сообщение если ключ не настроен
- ✅ **Обработка HTTP ошибок** - детальная информация об ошибках API
- ✅ **Таймауты** - защита от зависания запросов
- ✅ **Fallback** - graceful degradation при ошибках

## Стоимость

- **GPT-3.5-turbo**: ~$0.002 за 1K токенов
- **Примерная стоимость**: $0.01-0.05 за рекомендацию
- **Рекомендуется**: установить лимиты расходов в OpenAI Dashboard

## Безопасность

✅ **Безопасно настроено**:
- API ключ хранится в переменных окружения Vercel
- Ключ не попадает в код приложения
- Используется HTTPS для всех запросов
- Ограниченное количество токенов в ответе

## Проверка работы

После настройки API ключа:
1. Пройдите тест БПД
2. Перейдите в личный кабинет
3. Нажмите **"Получить рекомендацию"**
4. Должна появиться персональная рекомендация от ChatGPT

Если видите ошибку "API ключ ChatGPT не настроен" - проверьте переменные окружения в Vercel.
